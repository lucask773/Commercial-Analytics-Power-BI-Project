CREATE DATABASE COMERCIAL_KPI
GO

USE COMERCIAL_KPI
GO

CREATE TABLE Calendario (
    Data DATE PRIMARY KEY,
    Ano INT NOT NULL,
    Mes INT NOT NULL,
    Nome_Mes VARCHAR(15),
    Trimestre VARCHAR(2),
    Semana_Ano INT
);

CREATE TABLE Paises (
    ID_Pais INT IDENTITY(1,1) PRIMARY KEY,
    Nome_Pais VARCHAR(50) NOT NULL
);

CREATE TABLE Vendedores (
    ID_Vendedor INT PRIMARY KEY,
    Nome_Vendedor VARCHAR(100) NOT NULL,
    ID_Pais INT NOT NULL)


CREATE TABLE Empresas (
    ID_Empresa INT PRIMARY KEY,
    Nome_Empresa VARCHAR(150) NOT NULL,
    Segmento VARCHAR(50),
    ID_Pais INT NOT NULL)

CREATE TABLE Produtos (
    ID_Produto INT PRIMARY KEY,
    Nome_Produto VARCHAR(100) NOT NULL,
    Categoria VARCHAR(50)
)

CREATE TABLE Metas (
    Ano INT PRIMARY KEY,
    Meta_Anual DECIMAL(18,2) NOT NULL
)

CREATE TABLE Oportunidades (
    ID_Oportunidade INT PRIMARY KEY,
    Data_Oportunidade DATE NOT NULL,

    ID_Vendedor INT NOT NULL,
    ID_Empresa INT NOT NULL,
    ID_Produto INT NOT NULL,

    Estagio_Venda VARCHAR(30) NOT NULL,
    Valor DECIMAL(18,2) NOT NULL)

ALTER TABLE Vendedores
ADD CONSTRAINT FK_Vendedores_Paises
FOREIGN KEY (ID_Pais)
REFERENCES Paises(ID_Pais);

ALTER TABLE Empresas
ADD CONSTRAINT FK_Empresas_Paises
FOREIGN KEY (ID_Pais)
REFERENCES Paises(ID_Pais);

ALTER TABLE Oportunidades
ADD CONSTRAINT FK_Oportunidades_Vendedores
FOREIGN KEY (ID_Vendedor)
REFERENCES Vendedores(ID_Vendedor);

ALTER TABLE Oportunidades
ADD CONSTRAINT FK_Oportunidades_Empresas
FOREIGN KEY (ID_Empresa)
REFERENCES Empresas(ID_Empresa);

ALTER TABLE Oportunidades
ADD CONSTRAINT FK_Oportunidades_Produtos
FOREIGN KEY (ID_Produto)
REFERENCES Produtos(ID_Produto);

ALTER TABLE Oportunidades
ADD CONSTRAINT FK_Oportunidades_Calendario
FOREIGN KEY (Data_Oportunidade)
REFERENCES Calendario(Data);

